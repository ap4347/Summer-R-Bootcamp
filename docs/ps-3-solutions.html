<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>PS 3 Solutions | Summer R Bootcamp</title>
<meta name="author" content="Alex Pijyan">
<meta name="description" content="    Problem 1 (Use Base R) Compare the average age of local population for the US and non-US stores by displaying their boxplots. Customize your boxplots as follows: add labels, change the colors,...">
<meta name="generator" content="bookdown 0.32 with bs4_book()">
<meta property="og:title" content="PS 3 Solutions | Summer R Bootcamp">
<meta property="og:type" content="book">
<meta property="og:description" content="    Problem 1 (Use Base R) Compare the average age of local population for the US and non-US stores by displaying their boxplots. Customize your boxplots as follows: add labels, change the colors,...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PS 3 Solutions | Summer R Bootcamp">
<meta name="twitter:description" content="    Problem 1 (Use Base R) Compare the average age of local population for the US and non-US stores by displaying their boxplots. Customize your boxplots as follows: add labels, change the colors,...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Summer R Bootcamp</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li class="book-part">Week 1</li>
<li><a class="" href="introduction.html">Introduction</a></li>
<li><a class="" href="module-1.html">Module 1</a></li>
<li><a class="" href="module-2.html">Module 2</a></li>
<li><a class="" href="module-3.html">Module 3</a></li>
<li><a class="" href="module-4.html">Module 4</a></li>
<li><a class="" href="problem-set-1.html">Problem Set 1</a></li>
<li><a class="" href="ps-1-solutions.html">PS 1 Solutions</a></li>
<li class="book-part">Week 2</li>
<li><a class="" href="module-5.html">Module 5</a></li>
<li><a class="" href="module-6.html">Module 6</a></li>
<li><a class="" href="module-7.html">Module 7</a></li>
<li><a class="" href="problem-set-2.html">Problem Set 2</a></li>
<li><a class="" href="ps-2-solutions.html">PS 2 Solutions</a></li>
<li class="book-part">Week 3</li>
<li><a class="" href="module-8.html">Module 8</a></li>
<li><a class="" href="module-9.html">Module 9</a></li>
<li><a class="" href="module-10.html">Module 10</a></li>
<li><a class="" href="module-11.html">Module 11</a></li>
<li><a class="" href="problem-set-3.html">Problem Set 3</a></li>
<li><a class="active" href="ps-3-solutions.html">PS 3 Solutions</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ps-3-solutions" class="section level1 unnumbered">
<h1>PS 3 Solutions<a class="anchor" aria-label="anchor" href="#ps-3-solutions"><i class="fas fa-link"></i></a>
</h1>
<p> </p>
<p> </p>
<div id="problem-1-use-base-r-1" class="section level2 unnumbered">
<h2>Problem 1 (Use Base R)<a class="anchor" aria-label="anchor" href="#problem-1-use-base-r-1"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Compare the average age of local population for the US and non-US stores by displaying their boxplots. Customize your boxplots as follows: add labels, change the colors, and add notches.</li>
</ol>
<div class="sourceCode" id="cb449"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"carseats.csv"</span>, header <span class="op">=</span> <span class="cn">T</span>, stringsAsFactors <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">data1</span><span class="op">$</span><span class="va">Age</span> <span class="op">~</span> <span class="va">data1</span><span class="op">$</span><span class="va">US</span>,</span>
<span>        </span>
<span>        xlab <span class="op">=</span> <span class="st">"Store Loc."</span>,</span>
<span>        </span>
<span>        ylab <span class="op">=</span> <span class="st">"Age"</span>,</span>
<span>        </span>
<span>        names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Non-US"</span>, <span class="st">"US"</span><span class="op">)</span>,</span>
<span>        </span>
<span>        main <span class="op">=</span> <span class="st">"Age of Population for the US and non-US stores"</span>,</span>
<span>        </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="st">"lightcoral"</span><span class="op">)</span>,</span>
<span>        </span>
<span>        border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dodgerblue"</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>        </span>
<span>        notch <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="PS3_solutions_files/figure-html/unnamed-chunk-1-1.png" width="672"></div>
<p> </p>
<ol start="2" style="list-style-type: decimal">
<li>Summarize the quality of shelving locations by displaying its barplot. Customize it as discussed in the previous question ( no notches here).</li>
</ol>
<div class="sourceCode" id="cb450"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data1</span><span class="op">$</span><span class="va">ShelveLoc</span><span class="op">)</span>,</span>
<span>        </span>
<span>        xlab <span class="op">=</span> <span class="st">"Quality of Shelving Loc."</span>,</span>
<span>        </span>
<span>        ylab <span class="op">=</span> <span class="st">"Num. of Stores"</span>,</span>
<span>        </span>
<span>        main <span class="op">=</span> <span class="st">"Quality of Shelving Loc. Count"</span>,</span>
<span>        </span>
<span>        col <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>        </span>
<span>        border <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="PS3_solutions_files/figure-html/unnamed-chunk-2-1.png" width="672"></div>
<p> </p>
<ol start="3" style="list-style-type: decimal">
<li>Plot a side-by-side barplots displaying the frequency of <code>ShelveLoc</code> variable in urban and rural areas. Customize your plot as discussed above.</li>
</ol>
<div class="sourceCode" id="cb451"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data1</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ShelveLoc"</span>, <span class="st">"Urban"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        </span>
<span>        beside <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        </span>
<span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bad"</span>, <span class="st">"Good"</span>, <span class="st">"Medium"</span><span class="op">)</span>,</span>
<span>        </span>
<span>        ylab <span class="op">=</span> <span class="st">"Num. of Stores"</span>,</span>
<span>        </span>
<span>        xlab <span class="op">=</span> <span class="st">"Store Location: Urban"</span>,</span>
<span>        </span>
<span>        main <span class="op">=</span> <span class="st">"Qual. of Shelving Loc. vs Urban/Rural"</span>,</span>
<span>        </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="st">"lightcoral"</span>, <span class="st">"orange"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="PS3_solutions_files/figure-html/unnamed-chunk-3-1.png" width="672"></div>
<p> </p>
<ol start="4" style="list-style-type: decimal">
<li>Plot the <code>Sales</code> variable against the <code>Price</code> variable. Label the plot and axes accordingly, change the shape of points to triangular, change the color of points based on whether the store is located in urban (orange color) or rural (green color) area and add the corresponding legend to the plot, change the size of points to 0.9.</li>
</ol>
<div class="sourceCode" id="cb452"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"orange"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data1</span><span class="op">$</span><span class="va">Price</span>,</span>
<span>     </span>
<span>     y <span class="op">=</span> <span class="va">data1</span><span class="op">$</span><span class="va">Sales</span>,</span>
<span>     </span>
<span>     xlab <span class="op">=</span> <span class="st">"Price"</span>,</span>
<span>     </span>
<span>     ylab <span class="op">=</span> <span class="st">"Sales"</span>,</span>
<span>     </span>
<span>     main <span class="op">=</span> <span class="st">"Sales vs Price"</span>,</span>
<span>     </span>
<span>     col <span class="op">=</span> <span class="va">colors</span><span class="op">[</span><span class="va">data1</span><span class="op">$</span><span class="va">Urban</span><span class="op">]</span>,</span>
<span>     </span>
<span>     pch <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     </span>
<span>     cex  <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Rural"</span>, <span class="st">"Urban"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="va">colors</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="PS3_solutions_files/figure-html/unnamed-chunk-4-1.png" width="672"></div>
<p> </p>
<ol start="5" style="list-style-type: decimal">
<li>Combine a histogram of the <code>Price</code> variable and a boxplot of the <code>Population</code> variable in one image. Customize both plots as discussed in part (1) (no notches for the histogram).</li>
</ol>
<div class="sourceCode" id="cb453"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">data1</span><span class="op">$</span><span class="va">Price</span>,</span>
<span>     </span>
<span>     xlab <span class="op">=</span> <span class="st">"Price"</span>,</span>
<span>     </span>
<span>     ylab <span class="op">=</span> <span class="st">"Num. of Stores"</span>,</span>
<span>     </span>
<span>     main <span class="op">=</span> <span class="st">"Histogram of Price"</span>,</span>
<span>     </span>
<span>     col <span class="op">=</span> <span class="st">"pink"</span>,</span>
<span>     </span>
<span>     border <span class="op">=</span> <span class="st">"violetred"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">data1</span><span class="op">$</span><span class="va">Population</span>,</span>
<span>        </span>
<span>        xlab <span class="op">=</span> <span class="st">"Population"</span>,</span>
<span>        </span>
<span>        ylab <span class="op">=</span> <span class="st">"Values"</span>,</span>
<span>        </span>
<span>        main <span class="op">=</span> <span class="st">"Boxplot of Population"</span>,</span>
<span>        </span>
<span>        col <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>        </span>
<span>        border <span class="op">=</span> <span class="st">"dodgerblue"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="PS3_solutions_files/figure-html/unnamed-chunk-5-1.png" width="672"></div>
<p> </p>
</div>
<div id="problem-2-use-ggplot2-package-1" class="section level2 unnumbered">
<h2>Problem 2 (Use ggplot2 Package)<a class="anchor" aria-label="anchor" href="#problem-2-use-ggplot2-package-1"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Plot a histogram of the <code>Sale_Price</code> variable: add labels (title, subtitle, x and y labels); adjust the limits of the x axis by adding new ticks to it (step size = 100,000) and changing the angle of ticks to 60; change the theme to minimal; change the colors of bins and bin outlines (it is up to you to pick colors); add a blue vertical line that represents the mean value of the variable.</li>
</ol>
<div class="sourceCode" id="cb454"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"ames_housing.csv"</span>, header <span class="op">=</span> <span class="cn">T</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── Attaching packages ─────────────────── tidyverse 1.3.2 ──</span></span>
<span><span class="co">#&gt; ✔ ggplot2 3.3.6      ✔ purrr   0.3.5 </span></span>
<span><span class="co">#&gt; ✔ tibble  3.1.8      ✔ dplyr   1.0.10</span></span>
<span><span class="co">#&gt; ✔ tidyr   1.2.1      ✔ stringr 1.4.1 </span></span>
<span><span class="co">#&gt; ✔ readr   2.1.3      ✔ forcats 0.5.2 </span></span>
<span><span class="co">#&gt; ── Conflicts ────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span></span>
<span>    </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sale_Price</span><span class="op">)</span>,</span>
<span>               </span>
<span>               fill<span class="op">=</span><span class="st">"steelblue1"</span>,</span>
<span>               </span>
<span>               color<span class="op">=</span><span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Sale_Price</span><span class="op">)</span><span class="op">)</span>,</span>
<span>               </span>
<span>           color <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>               </span>
<span>           size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sale Price Histogram"</span>,</span>
<span>       </span>
<span>       subtitle <span class="op">=</span> <span class="st">"From ames_housing dataset"</span>,</span>
<span>       </span>
<span>       x <span class="op">=</span> <span class="st">"Sale Price"</span>,</span>
<span>       </span>
<span>       y <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">750000</span>, <span class="fl">100000</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">750000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">60</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">#&gt; `binwidth`.</span></span>
<span><span class="co">#&gt; Warning: Removed 1 rows containing non-finite values</span></span>
<span><span class="co">#&gt; (stat_bin).</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values</span></span>
<span><span class="co">#&gt; (geom_bar).</span></span></code></pre></div>
<div class="inline-figure"><img src="PS3_solutions_files/figure-html/unnamed-chunk-6-1.png" width="672"></div>
<p> </p>
<ol start="2" style="list-style-type: decimal">
<li>Use a stacked barplot to visualize the relationship between these two categorical variables (make sure the bars have the same height); add labels to the plot (title, subtitle, x and y labels).</li>
</ol>
<div class="sourceCode" id="cb455"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Roof_Style</span>, fill <span class="op">=</span> <span class="va">Fence</span><span class="op">)</span>,</span>
<span>           </span>
<span>           position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Distribution of Fence for Different Roof Style"</span>,</span>
<span>      </span>
<span>      subtitle<span class="op">=</span><span class="st">"From ames_housing dataset"</span>,</span>
<span>      </span>
<span>      x<span class="op">=</span><span class="st">"Roof Style"</span>,</span>
<span>      </span>
<span>      y<span class="op">=</span><span class="st">"Frequentist Probability"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="PS3_solutions_files/figure-html/unnamed-chunk-7-1.png" width="672"></div>
<p> </p>
<ol start="3" style="list-style-type: decimal">
<li>Plot a boxplot of the <code>Sales_Price</code> variable reflecting the <code>North_Ames</code> and <code>College_Creek</code> neighborhoods; add black dots to these boxplots that represent the average prices in these groups; make boxplots transparent (use transparency rate of 0.45).</li>
</ol>
<div class="sourceCode" id="cb456"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Neighborhood</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"College_Creek"</span>, <span class="st">"North_Ames"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Neighborhood</span>, y <span class="op">=</span> <span class="va">Sale_Price</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.45</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Neighborhood</span>, y <span class="op">=</span> <span class="va">Sale_Price</span><span class="op">)</span>,</span>
<span>               </span>
<span>             fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>               </span>
<span>             geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               </span>
<span>             color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="PS3_solutions_files/figure-html/unnamed-chunk-8-1.png" width="672"></div>
<p> </p>
<ol start="4" style="list-style-type: decimal">
<li>
<p>Add a new variable to the dataset (name it <code>Rooms</code>) that will split all homes in the dataset into the following three groups based on the total number of rooms above the ground: <code>"2-4"</code>, <code>"5-8"</code>, and <code>"9 or more"</code>. In other words, you need to create a factor variable with 3 levels by converting the <code>TotRms_AbvGrd</code> variable. (Hint: you might want to check out the <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> function from <code>dpyr</code> package).</p>
<p>Plot a barplot of the <code>Rooms</code> variable: add labels to this barplot that display the exact frequency of each category. Plot another barplot of the <code>Rooms</code> variable with labels that display the frequency of each category as percentages. Now create a composition (assemble) of these plots (it is up to you to pick a layout). In other words, combine these barplots in one plot.</p>
</li>
</ol>
<div class="sourceCode" id="cb457"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">categorize</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">x</span><span class="op">&lt;=</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">&gt;=</span><span class="fl">2</span> <span class="op">~</span> <span class="st">"2-4"</span>,</span>
<span>            </span>
<span>            <span class="va">x</span><span class="op">&lt;=</span><span class="fl">8</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">&gt;=</span><span class="fl">5</span> <span class="op">~</span> <span class="st">"5-8"</span>,</span>
<span>            </span>
<span>            <span class="va">x</span><span class="op">&gt;=</span><span class="fl">9</span> <span class="op">~</span> <span class="st">"9 or more"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Rooms <span class="op">=</span> <span class="fu">categorize</span><span class="op">(</span><span class="va">TotRms_AbvGrd</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb458"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Rooms</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"gray70"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Rooms</span>, label <span class="op">=</span> <span class="va">..count..</span><span class="op">)</span>,</span>
<span>            </span>
<span>            stat <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>            </span>
<span>            colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">Rooms</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>perc <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Rooms</span>, y <span class="op">=</span> <span class="va">perc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"gray70"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## add percentage labels</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">(</span><span class="va">perc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Percentage"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'patchwork' was built under R version 4.2.3</span></span>
<span></span>
<span><span class="va">gg1</span><span class="op">/</span><span class="va">gg2</span></span></code></pre></div>
<div class="inline-figure"><img src="PS3_solutions_files/figure-html/unnamed-chunk-10-1.png" width="672"></div>
<p> </p>
<ol start="5" style="list-style-type: decimal">
<li>Plot the <code>Sale_Price</code> variable (Y) against the <code>Gr_Liv_Area</code> variable (X): add labels to the scatterplot (title, subtitle, caption, x and y labels) and change their colors; change the size and shape of datapoints; change the color of datapoints based on the <code>Rooms</code> variable; move the legends to the left.</li>
</ol>
<div class="sourceCode" id="cb459"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Gr_Liv_Area</span>, y <span class="op">=</span> <span class="va">Sale_Price</span>, color <span class="op">=</span> <span class="va">Rooms</span><span class="op">)</span>,</span>
<span>               </span>
<span>             size <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>             </span>
<span>             shape <span class="op">=</span> <span class="fl">22</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Above Ground Living Area"</span>,</span>
<span>       </span>
<span>       y <span class="op">=</span> <span class="st">"Sale Price"</span>,</span>
<span>       </span>
<span>       title <span class="op">=</span> <span class="st">"Sale Price - Above Ground Living Area Scatter Plot"</span>,</span>
<span>       </span>
<span>       subtitle <span class="op">=</span> <span class="st">"From ames_housing data"</span>,</span>
<span>       </span>
<span>       caption <span class="op">=</span> <span class="st">"The plot resembles a correlation between sale price and above ground living area."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">15</span>, face<span class="op">=</span><span class="st">"bold"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>,</span>
<span>             </span>
<span>        axis.title.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>             </span>
<span>        axis.title.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>        </span>
<span>        legend.position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="PS3_solutions_files/figure-html/unnamed-chunk-11-1.png" width="672"></div>
<p> </p>
<ol start="6" style="list-style-type: decimal">
<li>Plot the <code>Sale_Price</code> variable (Y) against the <code>Gr_Liv_Area</code> variable (X) for each level of the <code>Rooms</code> variable separately, using facets.</li>
</ol>
<div class="sourceCode" id="cb460"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Gr_Liv_Area</span>, y <span class="op">=</span> <span class="va">Sale_Price</span><span class="op">)</span>,</span>
<span>             </span>
<span>             size <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>             </span>
<span>             shape <span class="op">=</span> <span class="fl">22</span>,</span>
<span>             </span>
<span>             color <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Rooms</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="PS3_solutions_files/figure-html/unnamed-chunk-12-1.png" width="672"></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="problem-set-3.html">Problem Set 3</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ps-3-solutions">PS 3 Solutions</a></li>
<li><a class="nav-link" href="#problem-1-use-base-r-1">Problem 1 (Use Base R)</a></li>
<li><a class="nav-link" href="#problem-2-use-ggplot2-package-1">Problem 2 (Use ggplot2 Package)</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/PS3_solutions.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/PS3_solutions.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Summer R Bootcamp</strong>" was written by Alex Pijyan. It was last built on 2023-07-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
